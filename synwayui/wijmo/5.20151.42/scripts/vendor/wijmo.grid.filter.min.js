/*
    *
    * Wijmo Library 5.20151.42
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    * 
    * Licensed under the Wijmo Commercial License. 
    * sales@wijmo.com
    * http://wijmo.com/products/wijmo-5/license/
    *
    */
var __extends,wijmo;(function(n){(function(t){(function(i){"use strict";var r=function(){function r(i){this._showIcons=!0;this.filterApplied=new n.Event;var r="Missing dependency: FlexGridFilter requires ";n.assert(n.grid.FlexGrid!=null,r+"wijmo.grid.");n.assert(n.input.ComboBox!=null,r+"wijmo.input.");this._filters=[];this._grid=n.asType(i,t.FlexGrid,!1);this._grid.formatItem.addHandler(this._formatItem.bind(this));this._grid.itemsSourceChanged.addHandler(this.clear.bind(this));this._grid.hostElement.addEventListener("mousedown",this._mouseDown.bind(this),!0);this._grid.invalidate()}return Object.defineProperty(r.prototype,"showFilterIcons",{get:function(){return this._showIcons},set:function(t){this._showIcons=n.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"filterColumns",{get:function(){return this._filterColumns},set:function(t){this._filterColumns=n.asArray(t);this.clear()},enumerable:!0,configurable:!0}),r.prototype.getColumnFilter=function(n,t){var r,u;for(typeof t=="undefined"&&(t=!0),r=0;r<this._filters.length;r++)if(this._filters[r].column==n)return this._filters[r];return t?(u=new i.ColumnFilter(n),this._filters.push(u),u):null},r.prototype.editColumnFilter=function(r){var f,s;this.closeEditor();r=n.isString(r)?this._grid.columns.getColumn(r):n.asType(r,t.Column,!1);var e=this._grid.columnHeaders,h=e.getCellBoundingRect(e.rows.length-1,r.index),u=document.createElement("div"),c=this.getColumnFilter(r,!0),o=new i.ColumnFilterEditor(u,c);n.addClass(u,"wj-dropdown-panel");f=this;o.filterChanged.addHandler(function(){f.closeEditor();f.apply()});u.addEventListener("blur",function(){setTimeout(function(){o.containsFocus()||f.closeEditor()},200)},!0);s=document.body;s.appendChild(u);u.tabIndex=-1;n.showPopup(u,h);u.focus();this._divEdt=u;this._edtCol=r},r.prototype.closeEditor=function(){this._divEdt&&(n.hidePopup(this._divEdt,!0),this._divEdt=null,this._edtCol=null)},r.prototype.apply=function(){var n=this._grid.collectionView;n&&(n.filter?n.refresh():n.filter=this._filter.bind(this));this.onFilterApplied()},r.prototype.clear=function(){this._filters=[];this.apply()},r.prototype.onFilterApplied=function(){this.filterApplied.raise(this)},r.prototype._filter=function(n){for(var t=0;t<this._filters.length;t++)if(!this._filters[t].apply(n))return!1;return!0},r.prototype._formatItem=function(n,t){var i;if(this._showIcons&&t.panel.cellType==2&&t.row==this._grid.columnHeaders.rows.length-1&&(i=this._grid.columns[t.col],!this._filterColumns||this._filterColumns.indexOf(i.binding)>-1)){var u=this.getColumnFilter(i,!0),f=u.isActive?.85:.25,e="<div "+r._WJA_FILTER+' style ="float:right;cursor:pointer;padding:0px 4px;opacity:'+f+'"><span class="wj-glyph-filter"><\/span><\/div>';t.cell.innerHTML=e+t.cell.innerHTML}},r.prototype._mouseDown=function(n){var t,i;this._hasAttribute(n.target,r._WJA_FILTER)&&(t=this._grid.hitTest(n),t.gridPanel==this._grid.columnHeaders&&(i=this._grid.columns[t.col],this._divEdt&&this._edtCol==i?this.closeEditor():this.editColumnFilter(i),n.stopPropagation(),n.preventDefault()))},r.prototype._hasAttribute=function(n,t){for(;n;n=n.parentNode)if(n.getAttribute&&n.getAttribute(t)!=null)return!0;return!1},r._WJA_FILTER="wj-filter",r}();i.FlexGridFilter=r})(t.filter||(t.filter={}));var i=t.filter})(n.grid||(n.grid={}));var t=n.grid})(wijmo||(wijmo={})),function(n){(function(t){(function(t){"use strict";var i=function(){function i(i){this._c1=new t.FilterCondition;this._c2=new t.FilterCondition;this._and=!0;this._col=i;this._bnd=i.binding?new n.Binding(i.binding):null}return Object.defineProperty(i.prototype,"column",{get:function(){return this._col},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"condition1",{get:function(){return this._c1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"condition2",{get:function(){return this._c2},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"and",{get:function(){return this._and},set:function(t){this._and=n.asBoolean(t);this._bnd=this.column&&this.column.binding?new n.Binding(this.column.binding):null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isActive",{get:function(){return this._c1._op!=null||this._c2._op!=null},enumerable:!0,configurable:!0}),i.prototype.apply=function(t){var i=this.column,r=this.condition1,u=this.condition2,f,e;return i.binding?(t=this._bnd.getValue(t),i.dataMap?t=i.dataMap.getDisplayValue(t):n.isDate(t)?(n.isString(r.value)||n.isString(u.value))&&(t=n.Globalize.format(t,i.format)):n.isBoolean(t)&&(t=t.toString()),f=r.apply(t),e=u.apply(t),r.operator!=null&&u.operator!=null?this._and?f&&e:f||e:r.operator!=null?f:u.operator!=null?e:!0):!0},i}();t.ColumnFilter=i})(t.filter||(t.filter={}));var i=t.filter})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){(function(t){(function(t){"use strict";n.culture.FlexGridFilter={header:"Show items where the value",and:"And",or:"Or",apply:"Apply",clear:"Clear",stringOperators:[{name:"(not set)",op:null},{name:"Equals",op:0},{name:"Does not equal",op:1},{name:"Begins with",op:6},{name:"Ends with",op:7},{name:"Contains",op:8},{name:"Does not contain",op:9}],numberOperators:[{name:"(not set)",op:null},{name:"Equals",op:0},{name:"Does not equal",op:1},{name:"Is Greater than",op:2},{name:"Is Greater than or equal to",op:3},{name:"Is Less than",op:4},{name:"Is Less than or equal to",op:5}],dateOperators:[{name:"(not set)",op:null},{name:"Equals",op:0},{name:"Is Before",op:4},{name:"Is After",op:2}],booleanOperators:[{name:"(not set)",op:null},{name:"Equals",op:0},{name:"Does not equal",op:1}]};var i=function(i){function r(r,u){var o,f,e;i.call(this,r);this.filterChanged=new n.Event;this._filter=n.asType(u,t.ColumnFilter,!1);o=this.getTemplate();this.applyTemplate("wj-control wj-columnfiltereditor wj-content",o,{_divHdr:"div-hdr",_divCmb1:"div-cmb1",_divVal1:"div-val1",_btnAnd:"btn-and",_btnOr:"btn-or",_spAnd:"sp-and",_spOr:"sp-or",_divCmb2:"div-cmb2",_divVal2:"div-val2",_btnApply:"btn-apply",_btnClear:"btn-clear"});this._divHdr.textContent=n.culture.FlexGridFilter.header;this._spAnd.textContent=n.culture.FlexGridFilter.and;this._spOr.textContent=n.culture.FlexGridFilter.or;this._btnApply.textContent=n.culture.FlexGridFilter.apply;this._btnClear.textContent=n.culture.FlexGridFilter.clear;this._cmb1=this._createOperatorCombo(this._divCmb1);this._cmb2=this._createOperatorCombo(this._divCmb2);this._val1=this._createValueInput(this._divVal1);this._val2=this._createValueInput(this._divVal2);f=this._btnAndOrChanged.bind(this);this._btnAnd.addEventListener("change",f);this._btnOr.addEventListener("change",f);e=this._btnApplyClearClicked.bind(this);this._btnApply.addEventListener("click",e);this._btnClear.addEventListener("click",e);this._updateUIFromFilter()}return __extends(r,i),Object.defineProperty(r.prototype,"filter",{get:function(){return this._filter},enumerable:!0,configurable:!0}),r.prototype.onFilterChanged=function(n){this.filterChanged.raise(this,n)},r.prototype._updateUIFromFilter=function(){var t=this._filter.condition1,i=this._filter.condition2;this._cmb1.selectedValue=t.operator;this._cmb2.selectedValue=i.operator;this._val1 instanceof n.input.ComboBox?(this._val1.text=t.value,this._val2.text=i.value):(this._val1.value=t.value,this._val2.value=i.value);this._btnAnd.checked=this._filter.and;this._btnOr.checked=!this._filter.and},r.prototype._updateFilterFromUI=function(){var t=this._filter.condition1,i=this._filter.condition2;t.operator=this._cmb1.selectedValue;i.operator=this._cmb2.selectedValue;this._val1 instanceof n.input.ComboBox?(t.value=this._val1.text,i.value=this._val2.text):(t.value=this._val1.value,i.value=this._val2.value);this._filter.and=this._btnAnd.checked},r.prototype._createOperatorCombo=function(t){var i=this._filter.column,u=n.culture.FlexGridFilter.stringOperators,r;return i.dataType!=4||this._isTimeFormat(i.format)?i.dataType!=2||i.dataMap?i.dataType!=3||i.dataMap||(u=n.culture.FlexGridFilter.booleanOperators):u=n.culture.FlexGridFilter.numberOperators:u=n.culture.FlexGridFilter.dateOperators,r=new n.input.ComboBox(t),r.itemsSource=u,r.displayMemberPath="name",r.selectedValuePath="op",r},r.prototype._createValueInput=function(t){var r=this._filter.column,i=null;return r.dataType!=4||this._isTimeFormat(r.format)?r.dataType!=2||r.dataMap?(i=new n.input.ComboBox(t),r.dataMap?(i.itemsSource=r.dataMap.getDisplayValues(),i.isEditable=!0):r.dataType==3&&(i.itemsSource=["true","false"])):(i=new n.input.InputNumber(t),i.format=r.format):(i=new n.input.InputDate(t),i.format=r.format),i.required=!1,i},r.prototype._isTimeFormat=function(t){return t?(t=n.culture.Globalize.calendar.patterns[t]||t,/[Hmst]+/.test(t)):!1},r.prototype._btnAndOrChanged=function(n){this._btnAnd.checked=n.target==this._btnAnd;this._btnOr.checked=n.target==this._btnOr},r.prototype._btnApplyClearClicked=function(n){n.preventDefault();n.stopPropagation();n.target==this._btnApply?this._updateFilterFromUI():n.target==this._btnClear&&(this._filter.condition1.operator=null,this._filter.condition2.operator=null,this._filter.and=!0,this._filter.condition1.value=null,this._filter.condition2.value=null);this._updateUIFromFilter();this.onFilterChanged()},r.controlTemplate='<div style="padding:6px"><div wj-part="div-hdr"><\/div><div wj-part="div-cmb1"><\/div><br/><div wj-part="div-val1"><\/div><br/><div><label><input wj-part="btn-and" type="radio"> <span wj-part="sp-and">And<\/span> <\/label>&nbsp;&nbsp;&nbsp;<label><input wj-part="btn-or" type="radio"> <span wj-part="sp-or">Or<\/span> <\/label><\/div><div wj-part="div-cmb2"><\/div><br/><div wj-part="div-val2"><\/div><br/><div style="text-align:right;margin-top:6px"><a wj-part="btn-apply" href="">Apply<\/a>&nbsp;&nbsp;&nbsp;<a wj-part="btn-clear" href="">Clear<\/a><\/div>',r}(n.Control);t.ColumnFilterEditor=i})(t.filter||(t.filter={}));var i=t.filter})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={})),function(n){(function(t){(function(t){"use strict";var r=function(){function t(){this._op=null}return Object.defineProperty(t.prototype,"operator",{get:function(){return this._op},set:function(t){this._op=n.asEnum(t,i,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._val},set:function(t){this._val=t;this._strVal=n.isString(t)?t.toString().toLowerCase():null},enumerable:!0,configurable:!0}),t.prototype.apply=function(t){var i=this._strVal||this._val;n.isString(t)&&(t=t.toLowerCase());switch(this._op){case null:return!0;case 0:return n.isDate(t)&&n.isDate(i)?n.DateTime.sameDate(t,i):t==i;case 1:return t!=i;case 2:return t>i;case 3:return t>=i;case 4:return t<i;case 5:return t<=i;case 6:return this._strVal&&n.isString(t)?t.indexOf(this._strVal)==0:!1;case 7:return this._strVal&&n.isString(t)&&t.length>=this._strVal.length?t.substr(t.length-this._strVal.length)==i:!1;case 8:return this._strVal&&n.isString(t)?t.indexOf(this._strVal)>-1:!1;case 9:return this._strVal&&n.isString(t)?t.indexOf(this._strVal)<0:!1}throw"Unknown operator";},t}(),i;t.FilterCondition=r,function(n){n[n.EQ=0]="EQ";n[n.NE=1]="NE";n[n.GT=2]="GT";n[n.GE=3]="GE";n[n.LT=4]="LT";n[n.LE=5]="LE";n[n.BW=6]="BW";n[n.EW=7]="EW";n[n.CT=8]="CT";n[n.NC=9]="NC"}(t.Operator||(t.Operator={}));i=t.Operator})(t.filter||(t.filter={}));var i=t.filter})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={}))